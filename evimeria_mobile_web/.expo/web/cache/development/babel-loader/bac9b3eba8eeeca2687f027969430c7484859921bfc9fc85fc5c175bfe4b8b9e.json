{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"D:\\\\Projects\\\\Evimeria_System\\\\evimeria_mobile_web\\\\src\\\\context\\\\AuthContext.js\",\n  _this = this;\nimport React, { createContext, useState, useEffect, useContext } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport api from '../services/api';\nimport { API_ENDPOINTS } from '../config/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar AuthContext = createContext({});\nexport var AuthProvider = function AuthProvider(_ref) {\n  var children = _ref.children;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    user = _useState2[0],\n    setUser = _useState2[1];\n  var _useState3 = useState(true),\n    _useState4 = _slicedToArray(_useState3, 2),\n    loading = _useState4[0],\n    setLoading = _useState4[1];\n  var _useState5 = useState(false),\n    _useState6 = _slicedToArray(_useState5, 2),\n    isAuthenticated = _useState6[0],\n    setIsAuthenticated = _useState6[1];\n  useEffect(function () {\n    loadStoredAuth();\n  }, []);\n  var loadStoredAuth = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      try {\n        var token = yield AsyncStorage.getItem('auth_token');\n        var userData = yield AsyncStorage.getItem('user_data');\n        if (token && userData) {\n          setUser(JSON.parse(userData));\n          setIsAuthenticated(true);\n        }\n      } catch (error) {\n        console.error('Error loading auth:', error);\n      } finally {\n        setLoading(false);\n      }\n    });\n    return function loadStoredAuth() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var login = function () {\n    var _ref3 = _asyncToGenerator(function* (email, password) {\n      try {\n        var response = yield api.post(API_ENDPOINTS.LOGIN, {\n          email: email,\n          password: password\n        });\n        var _response$data = response.data,\n          token = _response$data.token,\n          userData = _response$data.user,\n          requires_mfa = _response$data.requires_mfa;\n        if (requires_mfa) {\n          return {\n            requires_mfa: true,\n            user: userData\n          };\n        }\n        yield AsyncStorage.setItem('auth_token', token);\n        yield AsyncStorage.setItem('user_data', JSON.stringify(userData));\n        setUser(userData);\n        setIsAuthenticated(true);\n        return {\n          success: true\n        };\n      } catch (error) {\n        throw error;\n      }\n    });\n    return function login(_x, _x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var verifyMFA = function () {\n    var _ref4 = _asyncToGenerator(function* (email, code) {\n      try {\n        var response = yield api.post(API_ENDPOINTS.VERIFY_MFA, {\n          email: email,\n          code: code\n        });\n        var _response$data2 = response.data,\n          token = _response$data2.token,\n          userData = _response$data2.user;\n        yield AsyncStorage.setItem('auth_token', token);\n        yield AsyncStorage.setItem('user_data', JSON.stringify(userData));\n        setUser(userData);\n        setIsAuthenticated(true);\n        return {\n          success: true\n        };\n      } catch (error) {\n        throw error;\n      }\n    });\n    return function verifyMFA(_x3, _x4) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var logout = function () {\n    var _ref5 = _asyncToGenerator(function* () {\n      try {\n        yield api.post(API_ENDPOINTS.LOGOUT);\n      } catch (error) {\n        console.error('Logout error:', error);\n      } finally {\n        yield AsyncStorage.multiRemove(['auth_token', 'user_data']);\n        setUser(null);\n        setIsAuthenticated(false);\n      }\n    });\n    return function logout() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n  var register = function () {\n    var _ref6 = _asyncToGenerator(function* (data) {\n      try {\n        var response = yield api.post(API_ENDPOINTS.REGISTER, data);\n        return response.data;\n      } catch (error) {\n        throw error;\n      }\n    });\n    return function register(_x5) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n  return _jsxDEV(AuthContext.Provider, {\n    value: {\n      user: user,\n      loading: loading,\n      isAuthenticated: isAuthenticated,\n      login: login,\n      logout: logout,\n      register: register,\n      verifyMFA: verifyMFA\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 93,\n    columnNumber: 5\n  }, _this);\n};\nexport var useAuth = function useAuth() {\n  return useContext(AuthContext);\n};","map":{"version":3,"names":["React","createContext","useState","useEffect","useContext","AsyncStorage","api","API_ENDPOINTS","jsxDEV","_jsxDEV","AuthContext","AuthProvider","_ref","children","_useState","_useState2","_slicedToArray","user","setUser","_useState3","_useState4","loading","setLoading","_useState5","_useState6","isAuthenticated","setIsAuthenticated","loadStoredAuth","_ref2","_asyncToGenerator","token","getItem","userData","JSON","parse","error","console","apply","arguments","login","_ref3","email","password","response","post","LOGIN","_response$data","data","requires_mfa","setItem","stringify","success","_x","_x2","verifyMFA","_ref4","code","VERIFY_MFA","_response$data2","_x3","_x4","logout","_ref5","LOGOUT","multiRemove","register","_ref6","REGISTER","_x5","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_this","useAuth"],"sources":["D:/Projects/Evimeria_System/evimeria_mobile_web/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect, useContext } from 'react';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport api from '../services/api';\r\nimport { API_ENDPOINTS } from '../config/api';\r\n\r\nconst AuthContext = createContext({});\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n\r\n  useEffect(() => {\r\n    loadStoredAuth();\r\n  }, []);\r\n\r\n  const loadStoredAuth = async () => {\r\n    try {\r\n      const token = await AsyncStorage.getItem('auth_token');\r\n      const userData = await AsyncStorage.getItem('user_data');\r\n      \r\n      if (token && userData) {\r\n        setUser(JSON.parse(userData));\r\n        setIsAuthenticated(true);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading auth:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const login = async (email, password) => {\r\n    try {\r\n      const response = await api.post(API_ENDPOINTS.LOGIN, { email, password });\r\n      const { token, user: userData, requires_mfa } = response.data;\r\n      \r\n      if (requires_mfa) {\r\n        return { requires_mfa: true, user: userData };\r\n      }\r\n      \r\n      await AsyncStorage.setItem('auth_token', token);\r\n      await AsyncStorage.setItem('user_data', JSON.stringify(userData));\r\n      \r\n      setUser(userData);\r\n      setIsAuthenticated(true);\r\n      \r\n      return { success: true };\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const verifyMFA = async (email, code) => {\r\n    try {\r\n      const response = await api.post(API_ENDPOINTS.VERIFY_MFA, { email, code });\r\n      const { token, user: userData } = response.data;\r\n      \r\n      await AsyncStorage.setItem('auth_token', token);\r\n      await AsyncStorage.setItem('user_data', JSON.stringify(userData));\r\n      \r\n      setUser(userData);\r\n      setIsAuthenticated(true);\r\n      \r\n      return { success: true };\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const logout = async () => {\r\n    try {\r\n      await api.post(API_ENDPOINTS.LOGOUT);\r\n    } catch (error) {\r\n      console.error('Logout error:', error);\r\n    } finally {\r\n      await AsyncStorage.multiRemove(['auth_token', 'user_data']);\r\n      setUser(null);\r\n      setIsAuthenticated(false);\r\n    }\r\n  };\r\n\r\n  const register = async (data) => {\r\n    try {\r\n      const response = await api.post(API_ENDPOINTS.REGISTER, data);\r\n      return response.data;\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        user,\r\n        loading,\r\n        isAuthenticated,\r\n        login,\r\n        logout,\r\n        register,\r\n        verifyMFA,\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = () => useContext(AuthContext);\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}